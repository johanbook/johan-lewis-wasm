<!doctype html>
<html lang="en">
<head>
    <input type="file" id="file-input" accept="image/*" />
    <script type="module">
        import init, { decode_qr } from "./wasm-qr/pkg/wasm_qr.js";

        async function doStuff() {
            await init();

            var fileReader = new FileReader();
            fileReader.onloadend = e => decode_qr_from_reader(fileReader);
            var fileInputElement = document.getElementById("file");
            fileInputElement.addEventListener("change", e => fileReader.readAsArrayBuffer(fileInputElement.files[0]));

            // document.getElementById('file-input').addEventListener('change', function(event) {
            //     const file = event.target.files[0];
            //     if (file) {
            //         const reader = new FileReader();
            //         reader.onload = function(e) {
            //             const arrayBuffer = e.target.result; // Get the ArrayBuffer
            //             const uint8Array = new Uint8Array(arrayBuffer); // Convert to Uint8Array
            //             console.log({ uint8Array });
            //             const result = decode_qr(uint8Array); // Call decode_qr with the Uint8Array
            //             console.log({ result });
            //         };
            //         reader.readAsArrayBuffer(file); // Read the file as ArrayBuffer
            //     }
            // });
        }

        doStuff();
    </script>
</head>

<body>
    <div id="wasm-content"></div>
</body>
</html>
